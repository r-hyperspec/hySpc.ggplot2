<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plotting "hyperSpec" with "ggplot2" • hySpc.ggplot2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Plotting " hyperspec with>
<meta property="og:description" content="ggplot2: Package ggplot2 based functionality for hyperSpec">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hySpc.ggplot2</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Documentation for version of package:</li>
    <li>
      <a href="https://r-hyperspec.github.io/hySpc.ggplot2/">Released</a>
    </li>
    <li>
      <a href="https://r-hyperspec.github.io/hySpc.ggplot2/dev/">In-development</a>
    </li>
  </ul>
</li>
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/hySpc-ggplot2.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-hyperspec/hySpc.ggplot2/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="hySpc-ggplot2_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Plotting “hyperSpec” with “ggplot2”</h1>
                        <h4 class="author">Claudia Beleites<sup>1,2,3,4,5</sup>, Vilmantas Gegzna</h4>
            <address class="author_afil">
      <ol style="list-style-type: decimal">
<li>DIA Raman Spectroscopy Group, University of Trieste/Italy (2005–2008)</li>
      <li>Spectroscopy <span class="math inline">\(\cdot\)</span> Imaging, IPHT, Jena/Germany (2008–2017)</li>
      <li>ÖPV, JKI, Berlin/Germany (2017–2019)</li>
      <li>Arbeitskreis Lebensmittelmikrobiologie und Biotechnologie, Hamburg University, Hamburg/Germany (2019 – 2020)</li>
      <li>Chemometric Consulting and Chemometrix GmbH, Wölfersheim/Germany (since 2016)</li>
      </ol>
<br><a class="author_email" href="mailto:#"></a><a href="mailto:chemometrie@beleites.de" class="email">chemometrie@beleites.de</a>
      </address>
                  
            <h4 class="date">2020-08-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/r-hyperspec/hySpc.ggplot2/blob/master/vignettes/hySpc-ggplot2.Rmd"><code>vignettes/hySpc-ggplot2.Rmd</code></a></small>
      <div class="hidden name"><code>hySpc-ggplot2.Rmd</code></div>

    </div>

    
    
<div id="suggested-packages-and-setup" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#suggested-packages-and-setup" class="anchor"></a>Suggested Packages and Setup</h1>
<div class="note">
<p>
<strong>Reproducing the examples in this vignette.</strong>
</p>
<p>
All spectra used in this manual are installed automatically with package <strong>hyperSpec</strong>.
</p>
</div>
<hr>
<blockquote>
<p><strong>Terminology</strong>
Throughout the documentation of the package, the following terms are used:</p>
<ul>
<li>
<strong>wavelength</strong> indicates any type of spectral abscissa.</li>
<li>
<strong>intensity</strong> indicates any type of spectral ordinate.</li>
<li>
<strong>extra data</strong> indicates non-spectroscopic data.</li>
</ul>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://cbeleites.github.io/hyperSpec">hyperSpec</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://r-hyperspec.github.io/hySpc.ggplot2">hySpc.ggplot2</a></span>)

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>())

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">2020</span>)
</pre></div>
</div>
<div id="plots-ggplot2" class="section level1">
<h1 class="hasAnchor">
<a href="#plots-ggplot2" class="anchor"></a>Using <strong><em>ggplot2</em></strong> with <strong><em>hyperSpec</em></strong> objects</h1>
<p>Class <code class="sourceCode r">hyperSpec</code><span class="citation">[<a href="#ref-R-hyperSpec" role="doc-biblioref">1</a>]</span> objects do not yet directly support plotting with package <strong>ggplot2</strong><span class="citation">[<a href="#ref-R-ggplot2" role="doc-biblioref">2</a>,<a href="#ref-ggplot22016" role="doc-biblioref">3</a>]</span>.
Nevertheless, package <strong>ggplot2</strong> graphics can easily be obtained by using <code class="sourceCode r">qplot<span class="op">*</span>()</code> equivalents to <code class="sourceCode r">hyperSpec<span class="op">::</span><span class="kw">plotspc</span>()</code>, <code class="sourceCode r">hyperSpec<span class="op">::</span><span class="kw">plotc</span>()</code>, and <code class="sourceCode r">hyperSpec<span class="op">::</span><span class="kw">plotmap</span>()</code>.</p>
<div id="qplotspc" class="section level2">
<h2 class="hasAnchor">
<a href="#qplotspc" class="anchor"></a>Function <code class="sourceCode r"><span class="kw">qplotspc</span>()</code>
</h2>
<p>Plot spectra with <code class="sourceCode r"><span class="kw">qplotspc</span>()</code> (Fig. <a href="#fig:ggplotspc-01">1</a>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="../reference/qplotspc.html">qplotspc</a></span>(<span class="kw">flu</span>) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(colour = <span class="kw">c</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:ggplotspc-01"></span>
<img src="hySpc-ggplot2_files/figure-html/ggplotspc-01-1.png" alt="Spectra produced by `qplotspc()`{.r}: `flu` data.  "><p class="caption">
Figure 1: Spectra produced by <code class="sourceCode r"><span class="kw">qplotspc</span>()</code>: <code>flu</code> data.
</p>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="fu"><a href="../reference/qplotspc.html">qplotspc</a></span>(<span class="kw">paracetamol</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2800</span> <span class="op">~</span> <span class="kw">max</span>, <span class="kw">min</span> <span class="op">~</span> <span class="fl">1800</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_reverse</a></span>(breaks = <span class="fu"><a href="https://rdrr.io/pkg/hyperSpec/man/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">3200</span>, <span class="fl">400</span>))
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:ggplotspc-02"></span>
<img src="hySpc-ggplot2_files/figure-html/ggplotspc-02-1.png" alt="Spectra with reversed order of x axis values: `paracetamol` data.  "><p class="caption">
Figure 2: Spectra with reversed order of x axis values: <code>paracetamol</code> data.
</p>
</div>
<p>Let’s look at the other dataset called <code>faux_cell</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)
<span class="kw">faux_cell</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hyperSpec/man/faux_cell.html">generate_faux_cell</a></span>()
<span class="kw">faux_cell</span>
<span class="co">#&gt; hyperSpec object</span>
<span class="co">#&gt;    875 spectra</span>
<span class="co">#&gt;    4 data columns</span>
<span class="co">#&gt;    300 data points / spectrum</span>
<span class="co">#&gt; wavelength: Delta * tilde(nu)/cm^-1 [numeric] 602 606 ... 1798 </span>
<span class="co">#&gt; data:  (875 rows x 4 columns)</span>
<span class="co">#&gt;    1. x: x position [numeric] -11.55 -10.55 ... 22.45 </span>
<span class="co">#&gt;    2. y: y position [numeric] -4.77 -4.77 ... 19.23 </span>
<span class="co">#&gt;    3. region:  [factor] matrix matrix ... matrix </span>
<span class="co">#&gt;    4. spc: intensity (arbitrary units) [matrix, array300] 54 75 ... 108</span>
</pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">25</span>)
<span class="fu"><a href="../reference/qplotspc.html">qplotspc</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw">faux_cell</span>), spc.nmax = <span class="fl">10</span>) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(colour = <span class="kw">region</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:ggplotspc-03"></span>
<img src="hySpc-ggplot2_files/figure-html/ggplotspc-03-1.png" alt="Ten randomly selected spectra from `faux_cell` dataset.  "><p class="caption">
Figure 3: Ten randomly selected spectra from <code>faux_cell</code> dataset.
</p>
</div>
<p>Average spectra of each region.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu"><a href="../reference/qplotspc.html">qplotspc</a></span>(
  <span class="fu"><a href="https://rdrr.io/pkg/hyperSpec/man/aggregate.html">aggregate</a></span>(<span class="kw">faux_cell</span>, <span class="kw">faux_cell</span><span class="op">$</span><span class="kw">region</span>, <span class="kw">mean</span>),
  mapping = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">.wavelength</span>, y = <span class="kw">spc</span>, colour = <span class="kw">region</span>)
) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(<span class="kw">region</span> <span class="op">~</span> <span class="kw">.</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:ggplotspc-04"></span>
<img src="hySpc-ggplot2_files/figure-html/ggplotspc-04-1.png" alt="Mean spectra of each region in `faux_cell` dataset.  "><p class="caption">
Figure 4: Mean spectra of each region in <code>faux_cell</code> dataset.
</p>
</div>
<p>Mean <span class="math inline">\(\pm\)</span> standard deviation:</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu"><a href="../reference/qplotspc.html">qplotspc</a></span>(
 <span class="fu"><a href="https://rdrr.io/pkg/hyperSpec/man/aggregate.html">aggregate</a></span>(<span class="kw">faux_cell</span>, <span class="kw">faux_cell</span><span class="op">$</span><span class="kw">region</span>, <span class="kw">mean_pm_sd</span>),
 mapping = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">.wavelength</span>, y = <span class="kw">spc</span>, colour = <span class="kw">region</span>, group = <span class="kw">.rownames</span>)
) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(<span class="kw">region</span> <span class="op">~</span> <span class="kw">.</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:ggplotspc-05"></span>
<img src="hySpc-ggplot2_files/figure-html/ggplotspc-05-1.png" alt="Mean $\pm$ standard deviation spectra of each region in `faux_cell` dataset.  "><p class="caption">
Figure 5: Mean <span class="math inline">\(\pm\)</span> standard deviation spectra of each region in <code>faux_cell</code> dataset.
</p>
</div>
</div>
<div id="qplotc" class="section level2">
<h2 class="hasAnchor">
<a href="#qplotc" class="anchor"></a>Function <code class="sourceCode r"><span class="kw">qplotc</span>()</code>
</h2>
<p>This function plots spectroscopic concenration, depth, time-series, etc. profiles.</p>
<p>By default, plots spectrum only at the first wavelength.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="fu"><a href="../reference/qplotc.html">qplotc</a></span>(<span class="kw">flu</span>)
<span class="co">#&gt; Warning in qplotc(flu): Intensity at first wavelengh only is used.</span>
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:ggplotc-01"></span>
<img src="hySpc-ggplot2_files/figure-html/ggplotc-01-1.png" alt="Concentration profile: intensities at the first available wavelength value.  "><p class="caption">
Figure 6: Concentration profile: intensities at the first available wavelength value.
</p>
</div>
<p>It is better to indicate the wavelength of interest explicitly.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="fu"><a href="../reference/qplotc.html">qplotc</a></span>(<span class="kw">flu</span>[ , , <span class="fl">410</span>])
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:ggplotc-02"></span>
<img src="hySpc-ggplot2_files/figure-html/ggplotc-02-1.png" alt="Concentration profile: intensities at 410 nm.   "><p class="caption">
Figure 7: Concentration profile: intensities at 410 nm.
</p>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="fu"><a href="../reference/qplotc.html">qplotc</a></span>(<span class="kw">flu</span>[ , , <span class="fl">410</span>]) <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(method = <span class="st">"lm"</span>, formula = <span class="kw">y</span> <span class="op">~</span> <span class="kw">x</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:ggplotc-03"></span>
<img src="hySpc-ggplot2_files/figure-html/ggplotc-03-1.png" alt="Concentration profile with fitted line.  "><p class="caption">
Figure 8: Concentration profile with fitted line.
</p>
</div>
</div>
<div id="ggplotmap" class="section level2">
<h2 class="hasAnchor">
<a href="#ggplotmap" class="anchor"></a>Function <code class="sourceCode r"><span class="kw">ggplotmap</span>()</code>
</h2>
<p>Fig. <a href="#fig:ggplotmap-01">9</a> shows a map created with package <strong>ggplot2</strong>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">7</span>)
<span class="kw">faux_cell</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hyperSpec/man/faux_cell.html">generate_faux_cell</a></span>()
</pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="fu"><a href="../reference/qplotmap.html">qplotmap</a></span>(<span class="kw">faux_cell</span>[ , , <span class="fl">1200</span>])
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:ggplotmap-01"></span>
<img src="hySpc-ggplot2_files/figure-html/ggplotmap-01-1.png" alt="False-colour map produced by `qplotmap()`{.r}.  "><p class="caption">
Figure 9: False-colour map produced by <code class="sourceCode r"><span class="kw">qplotmap</span>()</code>.
</p>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="fu"><a href="../reference/qplotmap.html">qplotmap</a></span>(<span class="kw">faux_cell</span>[ , , <span class="fl">1200</span>]) <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span>(<span class="st">"Intensity"</span>, colours = <span class="fu"><a href="https://rdrr.io/pkg/hyperSpec/man/palettes.html">matlab.palette</a></span>())
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:ggplotmap-02"></span>
<img src="hySpc-ggplot2_files/figure-html/ggplotmap-02-1.png" alt="False-colour map produced by `qplotmap()`{.r}: different color palette.  "><p class="caption">
Figure 10: False-colour map produced by <code class="sourceCode r"><span class="kw">qplotmap</span>()</code>: different color palette.
</p>
</div>
<p>If you have package <strong>viridis</strong> installed, you may try:</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="fu"><a href="../reference/qplotmap.html">qplotmap</a></span>(<span class="kw">faux_cell</span>[ , , <span class="fl">1200</span>]) <span class="op">+</span>
    <span class="kw">viridis</span>::<span class="fu">scale_fill_viridis</span>(<span class="st">"Intensity"</span>)
</pre></div>
<p>The two special columns <code class="sourceCode r">.wavelength</code> and <code class="sourceCode r">.rownames</code> contain the wavelength axis and allow to distinguish the spectra.</p>
</div>
<div id="qplotmixmap" class="section level2">
<h2 class="hasAnchor">
<a href="#qplotmixmap" class="anchor"></a>Function <code class="sourceCode r"><span class="kw">qplotmixmap</span>()</code>
</h2>
<p>This function plots false-colour map with colour mixing for multivariate overlay.</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)
<span class="kw">faux_cell</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hyperSpec/man/faux_cell.html">generate_faux_cell</a></span>()
</pre></div>
<p>Without pre-processing:</p>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="fu"><a href="../reference/qplotmixmap.html">qplotmixmap</a></span>(<span class="kw">faux_cell</span>[, , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">800</span>, <span class="fl">1200</span>, <span class="fl">1500</span>)],
  purecol = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(matrix = <span class="st">"red"</span>, cell = <span class="st">"green"</span>, nucleus = <span class="st">"blue"</span>)
)
<span class="co">#&gt; Warning: Removed 300 rows containing missing values (geom_point).</span>
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:qplotmixmap-01"></span>
<img src="hySpc-ggplot2_files/figure-html/qplotmixmap-01-1.png" alt="False-color map produced by `qplotmixmap()`{.r}: raw `faux_cell` spectra at 800, 1200, and 1500 $cm^{-1}.$    "><p class="caption">
Figure 11: False-color map produced by <code class="sourceCode r"><span class="kw">qplotmixmap</span>()</code>: raw <code>faux_cell</code> spectra at 800, 1200, and 1500 <span class="math inline">\(cm^{-1}.\)</span>
</p>
</div>
<p>With baseline removed:</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="kw">faux_cell_2</span> <span class="op">&lt;-</span> <span class="kw">faux_cell</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/hyperSpec/man/baselines.html">spc.fit.poly.below</a></span>(<span class="kw">faux_cell</span>)

<span class="fu"><a href="../reference/qplotmixmap.html">qplotmixmap</a></span>(<span class="kw">faux_cell_2</span>[, , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">800</span>, <span class="fl">1200</span>, <span class="fl">1500</span>)],
  purecol = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(matrix = <span class="st">"red"</span>, cell = <span class="st">"green"</span>, nucleus = <span class="st">"blue"</span>)
)
<span class="co">#&gt; Warning: Removed 300 rows containing missing values (geom_point).</span>
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:qplotmixmap-02"></span>
<img src="hySpc-ggplot2_files/figure-html/qplotmixmap-02-1.png" alt="False-color map of `faux_cell` spectra with base line removed.  "><p class="caption">
Figure 12: False-color map of <code>faux_cell</code> spectra with base line removed.
</p>
</div>
<p>With some further pre-processing:</p>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="kw">faux_cell_3</span> <span class="op">&lt;-</span> <span class="kw">faux_cell_2</span>
<span class="kw">faux_cell_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hyperSpec/man/sweep.html">sweep</a></span>(<span class="kw">faux_cell_3</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/pkg/hyperSpec/man/apply.html">apply</a></span>(<span class="kw">faux_cell_3</span>, <span class="fl">1</span>, <span class="kw">mean</span>), <span class="st">"/"</span>)
<span class="kw">faux_cell_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hyperSpec/man/sweep.html">sweep</a></span>(<span class="kw">faux_cell_3</span>, <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/pkg/hyperSpec/man/apply.html">apply</a></span>(<span class="kw">faux_cell_3</span>, <span class="fl">2</span>, <span class="kw">quantile</span>, <span class="fl">0.05</span>), <span class="st">"-"</span>)

<span class="fu"><a href="../reference/qplotmixmap.html">qplotmixmap</a></span>(<span class="kw">faux_cell_3</span>[, , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">800</span>, <span class="fl">1200</span>, <span class="fl">1500</span>)],
  purecol = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(matrix = <span class="st">"red"</span>, cell = <span class="st">"green"</span>, nucleus = <span class="st">"blue"</span>)
)
<span class="co">#&gt; Warning: Removed 300 rows containing missing values (geom_point).</span>
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:qplotmixmap-03"></span>
<img src="hySpc-ggplot2_files/figure-html/qplotmixmap-03-1.png" alt="False-color map of pre-processed `faux_cell` spectra.  "><p class="caption">
Figure 13: False-color map of pre-processed <code>faux_cell</code> spectra.
</p>
</div>
</div>
<div id="general-plotting-ggplot2" class="section level2">
<h2 class="hasAnchor">
<a href="#general-plotting-ggplot2" class="anchor"></a>More General Plotting with <strong><em>ggplot2</em></strong>
</h2>
<p>For more general plotting, <code class="sourceCode r"><span class="kw">as.long.df</span>()</code> transforms a <code class="sourceCode r">hyperSpec</code> object into a long-form <code class="sourceCode r">data.frame</code> that is suitable for <code class="sourceCode r"><span class="kw">qplot</span>()</code>, while <code class="sourceCode r"><span class="kw">as.t.df</span>()</code> produces a <code class="sourceCode r">data.frame</code> where each spectrum is one column, and an additional first column gives the wavelength.
Long <code class="sourceCode r">data.frame</code>s can be <em>very</em> memory consuming as they are of size <span class="math inline">\(nrow · nwl × (ncol + 2)\)</span> with respect to the dimensions of the <code class="sourceCode r">hyperSpec</code> object.
Thus, e.g., the <code class="sourceCode r">faux_cell</code> data set (2 MB) as <code class="sourceCode r">hyperSpec</code> object) needs 26 MB as long-format <code class="sourceCode r">data.frame</code>.
It is therefore highly recommended to calculate the particular data to be plotted beforehand.</p>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="fu"><a href="../reference/qplotspc.html">qplotspc</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">faux_cell</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(
    ymin = <span class="kw">mean</span> <span class="op">+</span> <span class="kw">sd</span>,
    ymax = <span class="kw">mean</span> <span class="op">-</span> <span class="kw">sd</span>,
    y = <span class="fl">0</span>,
    group = <span class="fl">NA</span>
  ),
    alpha = <span class="fl">0.25</span>,
    data = <span class="fu"><a href="https://rdrr.io/pkg/hyperSpec/man/asdataframe.html">as.t.df</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/hyperSpec/man/mean_sd.html">mean_sd</a></span>(<span class="kw">faux_cell</span>))
  )
</pre></div>
<p>Note that <code class="sourceCode r"><span class="kw">qpotspc</span>()</code> specifies aesthetics <code>y = spc</code> and <code>groups = .rownames</code>, which do not have corresponding columns in the <code>data.frame</code> returned by <code class="sourceCode r"><span class="kw">as.t.df</span>()</code>.
These aesthetics must therefore be set manually in the aesthetics definition in <code class="sourceCode r"><span class="kw">geom_ribbon</span>()</code> (or any other <code class="sourceCode r">geom_<span class="op">*</span>()</code> that uses <code class="sourceCode r"><span class="kw">as.t.df</span>()</code>).
Otherwise, errors occur that object <code>spc</code> (and/or <code>.rownames</code>) cannot be found.
Cut axes can be implemented by faceting (Fig. <a href="#fig:ggplotspccut">14</a>).</p>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="fu"><a href="../reference/qplotspc.html">qplotspc</a></span>(<span class="kw">paracetamol</span> <span class="op">/</span> <span class="fl">1e4</span>, wl.range = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">min</span> <span class="op">~</span> <span class="fl">1800</span>, <span class="fl">2800</span> <span class="op">~</span> <span class="kw">max</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(breaks = <span class="fu"><a href="https://rdrr.io/pkg/hyperSpec/man/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">3200</span>, <span class="fl">400</span>))
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:ggplotspccut"></span>
<img src="hySpc-ggplot2_files/figure-html/ggplotspccut-1.png" alt="Plot separate regions of specra.  "><p class="caption">
Figure 14: Plot separate regions of specra.
</p>
</div>
</div>
</div>
<div id="session-info" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session Info</h1>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="kw">sessioninfo</span>::<span class="fu"><a href="https://rdrr.io/pkg/sessioninfo/man/session_info.html">session_info</a></span>(<span class="st">"hyperSpec"</span>)
<span class="co">#&gt; ─ Session info ───────────────────────────────────────────────────────────────────────────────────</span>
<span class="co">#&gt;  setting  value                       </span>
<span class="co">#&gt;  version  R version 4.0.2 (2020-06-22)</span>
<span class="co">#&gt;  os       macOS Catalina 10.15.6      </span>
<span class="co">#&gt;  system   x86_64, darwin17.0          </span>
<span class="co">#&gt;  ui       X11                         </span>
<span class="co">#&gt;  language (EN)                        </span>
<span class="co">#&gt;  collate  en_US.UTF-8                 </span>
<span class="co">#&gt;  ctype    en_US.UTF-8                 </span>
<span class="co">#&gt;  tz       UTC                         </span>
<span class="co">#&gt;  date     2020-08-05                  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ─ Packages ───────────────────────────────────────────────────────────────────────────────────────</span>
<span class="co">#&gt;  package      * version       date       lib source                            </span>
<span class="co">#&gt;  assertthat     0.2.1         2019-03-21 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  backports      1.1.8         2020-06-17 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  callr          3.4.3         2020-03-28 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  cli            2.0.2         2020-02-28 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  colorspace     1.4-1         2019-03-18 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  crayon         1.3.4         2017-09-16 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  desc           1.2.0         2018-05-01 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  digest         0.6.25        2020-02-23 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  dplyr          1.0.1         2020-07-31 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  ellipsis       0.3.1         2020-05-15 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  evaluate       0.14          2019-05-28 [1] CRAN (R 4.0.1)                    </span>
<span class="co">#&gt;  fansi          0.4.1         2020-01-08 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  farver         2.0.3         2020-01-16 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  generics       0.0.2         2018-11-29 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  ggplot2      * 3.3.2         2020-06-19 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  glue           1.4.1         2020-05-13 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  gtable         0.3.0         2019-03-25 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  hyperSpec    * 0.99-20200728 2020-07-28 [1] Github (GegznaV/hyperSpec@023bb64)</span>
<span class="co">#&gt;  isoband        0.2.2         2020-06-20 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  jpeg           0.1-8.1       2019-10-24 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  labeling       0.3           2014-08-23 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  lattice      * 0.20-41       2020-04-02 [2] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  latticeExtra   0.6-29        2019-12-19 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  lazyeval       0.2.2         2019-03-15 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  lifecycle      0.2.0         2020-03-06 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  magrittr       1.5           2014-11-22 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  MASS           7.3-51.6      2020-04-26 [2] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  Matrix         1.2-18        2019-11-27 [2] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  mgcv           1.8-31        2019-11-09 [2] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  munsell        0.5.0         2018-06-12 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  nlme           3.1-148       2020-05-24 [2] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  pillar         1.4.6         2020-07-10 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  pkgbuild       1.1.0         2020-07-13 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  pkgconfig      2.0.3         2019-09-22 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  pkgload        1.1.0         2020-05-29 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  png            0.1-7         2013-12-03 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  praise         1.0.0         2015-08-11 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  prettyunits    1.1.1         2020-01-24 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  processx       3.4.3         2020-07-05 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  ps             1.3.3         2020-05-08 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  purrr          0.3.4         2020-04-17 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  R6             2.4.1         2019-11-12 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  RColorBrewer   1.1-2         2014-12-07 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  rlang          0.4.7         2020-07-09 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  rprojroot      1.3-2         2018-01-03 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  rstudioapi     0.11          2020-02-07 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  scales         1.1.1         2020-05-11 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  testthat       2.3.2         2020-03-02 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  tibble         3.0.3         2020-07-10 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  tidyselect     1.1.0         2020-05-11 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  utf8           1.1.4         2018-05-24 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  vctrs          0.3.2         2020-07-15 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  viridisLite    0.3.0         2018-02-01 [1] CRAN (R 4.0.1)                    </span>
<span class="co">#&gt;  withr          2.2.0         2020-04-20 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt;  xml2           1.3.2         2020-04-23 [1] CRAN (R 4.0.2)                    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [1] /Users/runner/work/_temp/Library</span>
<span class="co">#&gt; [2] /Library/Frameworks/R.framework/Versions/4.0/Resources/library</span>
</pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-R-hyperSpec">
<p>[1] C. Beleites, V. Sergo, HyperSpec: Work with hyperspectral data, i.e. Spectra + meta information (spatial, time, concentration, ...), 2020.</p>
</div>
<div id="ref-R-ggplot2">
<p>[2] H. Wickham, W. Chang, L. Henry, T.L. Pedersen, K. Takahashi, C. Wilke, K. Woo, H. Yutani, D. Dunnington, Ggplot2: Create elegant data visualisations using the grammar of graphics, 2020. <a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a>.</p>
</div>
<div id="ref-ggplot22016">
<p>[3] H. Wickham, Ggplot2: Elegant graphics for data analysis, Springer-Verlag New York, 2016. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Claudia Beleites.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
